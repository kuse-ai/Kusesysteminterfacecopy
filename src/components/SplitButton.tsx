import React from 'react';
import './SplitButton.css';
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from './ui/tooltip';

function GlobeIcon() {
    return (
        <div className="relative shrink-0 w-6 h-6">
          <svg className="block w-full h-full" fill="none" preserveAspectRatio="none" viewBox="0 0 24 24">
            <path d="M12.259 4.2043C13.5525 4.24678 14.8169 4.61062 15.9367 5.26484C17.1311 5.96268 18.1182 6.96581 18.7971 8.17109L18.9172 8.3918C19.4984 9.50434 19.8019 10.7425 19.8 12.0002L19.7961 12.2512C19.7775 12.8361 19.6942 13.4053 19.5539 13.9514V13.9523C19.1206 15.6259 18.1436 17.1089 16.7766 18.1672C15.4094 19.2255 13.7291 19.7999 12.0002 19.8C10.2713 19.7999 8.59101 19.2255 7.22383 18.1672C5.8567 17.1089 4.87986 15.626 4.44648 13.9523V13.9514C4.28254 13.3137 4.19981 12.6577 4.20039 11.9992C4.20053 10.6096 4.56424 9.30173 5.20332 8.17012C5.88219 6.96515 6.86948 5.96251 8.06367 5.26484C9.25818 4.567 10.6168 4.19982 12.0002 4.20039L12.259 4.2043ZM9.64766 16.0148C9.75229 16.3037 9.86709 16.5738 9.99141 16.8225C10.5723 17.9843 11.2631 18.5303 11.8781 18.5939L12.0002 18.5998C12.6444 18.5997 13.3894 18.0616 14.009 16.8225C14.1329 16.5745 14.2464 16.3047 14.3508 16.0168C13.5759 16.1391 12.7901 16.2016 12.0002 16.2004C11.1999 16.2004 10.4142 16.1356 9.64766 16.0148ZM6.12227 15.0021C6.56164 15.8615 7.18578 16.62 7.9582 17.218C8.37273 17.5389 8.82193 17.8065 9.29414 18.0188C9.15888 17.8096 9.03287 17.589 8.91816 17.3596C8.67522 16.8737 8.46716 16.3281 8.29805 15.7375C7.54866 15.5472 6.82205 15.3005 6.12227 15.0021ZM17.8762 15.0031C17.1701 15.304 16.4432 15.5499 15.7014 15.7385C15.5323 16.3287 15.325 16.874 15.0822 17.3596C14.9676 17.5889 14.8405 17.8087 14.7053 18.0178C15.1775 17.8056 15.6267 17.5389 16.0412 17.218C16.8134 16.6202 17.4368 15.862 17.8762 15.0031ZM7.8 12.0002C7.8 11.4983 7.82477 11.0061 7.87227 10.5285C7.18254 10.2229 6.53377 9.84249 5.93477 9.39863C5.59203 10.1966 5.39961 11.0755 5.39961 12.0002L5.41328 12.4182C5.43395 12.7494 5.48182 13.078 5.55195 13.4025C6.32699 13.8129 7.1455 14.1512 7.99922 14.4094C7.8704 13.6482 7.80001 12.838 7.8 12.0002ZM12.0002 5.39961C11.356 5.39961 10.611 5.93796 9.99141 7.17695C9.63875 7.88227 9.35886 8.76009 9.1877 9.75117C10.0725 10.042 11.0179 10.2004 12.0002 10.2004H12.0012C12.9634 10.2017 13.9109 10.0459 14.8107 9.7502C14.6396 8.75961 14.3615 7.88198 14.009 7.17695C13.3894 5.93797 12.6444 5.39972 12.0002 5.39961ZM9.29316 5.98262C9.08058 6.07818 8.87153 6.18274 8.66914 6.30098C7.80359 6.80665 7.06749 7.50243 6.51289 8.33223C6.99068 8.70044 7.50604 9.02185 8.05293 9.28926C8.24482 8.29729 8.5399 7.39735 8.91816 6.64082C9.03266 6.41183 9.15819 6.1915 9.29316 5.98262ZM14.7072 5.98359C14.842 6.19222 14.9679 6.41214 15.0822 6.64082C15.4604 7.39729 15.7546 8.2974 15.9465 9.28926C16.4884 9.02458 17.0042 8.70429 17.4865 8.33223C16.932 7.50259 16.1966 6.80658 15.3313 6.30098C15.129 6.18284 14.9196 6.0791 14.7072 5.98359ZM9.0002 12.0002C9.00021 12.9782 9.10187 13.9012 9.28145 14.7307C10.1603 14.9062 11.0692 15.0002 12.0002 15.0002H12.0012C12.9168 15.0016 13.8261 14.9089 14.717 14.7307C14.8966 13.9011 15.0002 12.9784 15.0002 12.0002C15.0002 11.6457 14.9857 11.2983 14.9602 10.9602C14.0075 11.2489 13.0112 11.4 12.0002 11.3986V11.3996C10.9704 11.3996 9.97671 11.2442 9.03926 10.9602C9.0137 11.2983 9.0002 11.6457 9.0002 12.0002ZM16.2004 12.0002C16.2004 12.838 16.129 13.6482 16.0002 14.4094C16.8439 14.1541 17.6632 13.8167 18.4475 13.4016C18.5449 12.95 18.5998 12.4817 18.5998 12.0002V11.9992C18.6012 11.1023 18.4166 10.2182 18.0646 9.39863C17.4595 9.84733 16.8096 10.2244 16.1271 10.5266C16.1748 11.0047 16.2004 11.4976 16.2004 12.0002Z" fill="#6A4040" opacity="0.6" />
          </svg>
        </div>
    )
}

function WebSearchOffIcon() {
    return (
        <div className="opacity-20 relative shrink-0 w-4 h-4 flex items-center justify-center">
             <svg className="block w-full h-full" fill="none" preserveAspectRatio="none" viewBox="0 0 17 16">
                <g>
                  <line stroke="#6A4040" strokeLinecap="round" strokeWidth="1.5" x1="2.00196" x2="15.9413" y1="14.9413" y2="1.00195" />
                  <path d="M13.5713 2.55274C13.9633 2.98392 14.3083 3.45863 14.5967 3.9707L14.7168 4.19141C15.2981 5.30395 15.6015 6.54208 15.5996 7.79981L15.5957 8.05078C15.5771 8.63575 15.4938 9.20486 15.3535 9.75098V9.75195C14.9202 11.4256 13.9432 12.9085 12.5762 13.9668C11.209 15.0251 9.52869 15.5995 7.79981 15.5996C6.07087 15.5995 4.39062 15.0251 3.02344 13.9668C2.86085 13.8409 2.70403 13.7088 2.55274 13.5713L3.40332 12.7207C3.518 12.8232 3.63556 12.9229 3.75782 13.0176C4.17234 13.3385 4.62154 13.6062 5.09375 13.8184C4.95849 13.6092 4.83249 13.3886 4.71778 13.1592C4.52703 12.7777 4.35866 12.3591 4.21289 11.9111L5.51563 10.6084C6.25856 10.7326 7.02136 10.7998 7.79981 10.7998H7.80078C8.71636 10.8012 9.62569 10.7085 10.5166 10.5303C10.6962 9.70076 10.7998 8.77796 10.7998 7.79981C10.7998 7.44533 10.7853 7.09796 10.7598 6.75977C10.1863 6.93356 9.59679 7.05515 8.99805 7.12598L10.5596 5.56445C10.5763 5.55905 10.5936 5.5553 10.6104 5.54981C10.6086 5.53967 10.6063 5.52964 10.6045 5.51953L11.6172 4.50684C11.6635 4.69707 11.7078 4.89091 11.7461 5.08887C12.288 4.82419 12.8038 4.5039 13.2861 4.13184C13.1147 3.87543 12.9242 3.6335 12.7197 3.4043L13.5713 2.55274ZM5.44727 11.8145C5.5519 12.1033 5.66671 12.3734 5.79102 12.6221C6.37195 13.7839 7.06275 14.3299 7.67774 14.3936L7.79981 14.3994C8.44402 14.3993 9.18902 13.8612 9.8086 12.6221C9.93256 12.3741 10.046 12.1044 10.1504 11.8164C9.37554 11.9387 8.5897 12.0012 7.79981 12C6.99953 12 6.21384 11.9352 5.44727 11.8145ZM13.6758 10.8027C12.9697 11.1036 12.2428 11.3495 11.501 11.5381C11.3319 12.1283 11.1246 12.6736 10.8818 13.1592C10.7672 13.3885 10.6401 13.6083 10.5049 13.8174C10.9771 13.6052 11.4263 13.3385 11.8408 13.0176C12.613 12.4199 13.2364 11.6616 13.6758 10.8027ZM8.0586 0.0039069C9.35211 0.0463864 10.6165 0.410236 11.7363 1.06445C11.9869 1.21084 12.2276 1.37164 12.459 1.54395L11.5986 2.4043C11.4469 2.2974 11.2919 2.19466 11.1309 2.10059C10.9286 1.98245 10.7192 1.87871 10.5068 1.7832C10.6416 1.99183 10.7675 2.21175 10.8818 2.44043C10.9569 2.59053 11.0264 2.7472 11.0947 2.9082L10.1689 3.83399C10.0599 3.52639 9.93997 3.2393 9.8086 2.97656C9.18904 1.73758 8.44398 1.19933 7.79981 1.19922C7.15562 1.19922 6.41062 1.73757 5.79102 2.97656C5.43836 3.68188 5.15847 4.5597 4.98731 5.55078C5.87211 5.84163 6.8175 6 7.79981 6H7.80078C7.86989 6.0001 7.93887 5.99664 8.00782 5.99512L6.85059 7.15234C6.15779 7.08755 5.48484 6.95553 4.83887 6.75977C4.81331 7.09794 4.79981 7.44535 4.79981 7.79981C4.79981 8.25926 4.82283 8.70652 4.86524 9.1377L3.79785 10.2051C3.66946 9.44507 3.59962 8.63615 3.59961 7.79981C3.59961 7.29793 3.62438 6.80657 3.67188 6.32813C2.98215 6.02246 2.33338 5.6421 1.73438 5.19824C1.39164 5.99624 1.19922 6.87514 1.19922 7.79981L1.21289 8.21777C1.23356 8.54897 1.28144 8.87765 1.35157 9.20215C2.12544 9.61191 2.9426 9.94996 3.79492 10.208L2.84571 11.1572C2.53324 11.0479 2.22463 10.9308 1.92188 10.8018C2.06349 11.0787 2.22651 11.3436 2.40528 11.5977L1.54492 12.458C0.945331 11.6533 0.500954 10.7362 0.246097 9.75195V9.75098C0.0821556 9.11327 -0.000582822 8.45727 3.09006e-06 7.79883C0.000139712 6.40923 0.363855 5.10134 1.00293 3.96973C1.6818 2.76476 2.66909 1.76212 3.86328 1.06445C5.05779 0.366615 6.4164 -0.000565013 7.79981 6.52595e-07L8.0586 0.0039069ZM13.8643 5.19824C13.2591 5.64693 12.6092 6.02398 11.9268 6.32617C11.9744 6.80434 12 7.29723 12 7.79981C12 8.63764 11.9286 9.4478 11.7998 10.209C12.6435 9.95366 13.4628 9.61635 14.2471 9.20117C14.3445 8.74958 14.3994 8.28127 14.3994 7.79981V7.79883C14.4008 6.90195 14.2162 6.01781 13.8643 5.19824ZM5.09278 1.78223C4.88019 1.87779 4.67114 1.98235 4.46875 2.10059C3.6032 2.60626 2.8671 3.30204 2.3125 4.13184C2.79029 4.50005 3.30566 4.82146 3.85254 5.08887C4.04444 4.0969 4.33951 3.19696 4.71778 2.44043C4.83227 2.21144 4.9578 1.9911 5.09278 1.78223Z" fill="#6A4040" />
                </g>
             </svg>
        </div>
    )
}

interface SplitButtonProps extends React.HTMLAttributes<HTMLDivElement> {
    isWebSearch: boolean;
    onToggleWebSearch: () => void;
    label: string;
}

export const SplitButton = React.forwardRef<HTMLDivElement, SplitButtonProps>(
    ({ isWebSearch, onToggleWebSearch, label, className, ...props }, ref) => {
        return (
            <div 
                ref={ref} 
                className={`sb-container ${className || ''}`} 
                {...props}
            >
                <TooltipProvider>
                    {/* Icon Wrapper - Toggle Web Search */}
                    <Tooltip>
                        <TooltipTrigger asChild>
                            <div 
                                className="sb-icon-wrapper"
                                onClick={(e) => {
                                    e.stopPropagation();
                                    onToggleWebSearch();
                                }}
                            >
                                {isWebSearch ? <GlobeIcon /> : <WebSearchOffIcon />}
                            </div>
                        </TooltipTrigger>
                        <TooltipContent side="top">
                            <p>{isWebSearch ? "Turn off Web Search" : "Turn on Web Search"}</p>
                        </TooltipContent>
                    </Tooltip>

                    {/* Text Wrapper - Opens Dialog */}
                    <Tooltip>
                        <TooltipTrigger asChild>
                            <div className="sb-text-wrapper">
                                <span className="sb-text">
                                    {label}
                                </span>
                            </div>
                        </TooltipTrigger>
                        <TooltipContent side="top">
                            <p>Select Sources</p>
                        </TooltipContent>
                    </Tooltip>
                </TooltipProvider>
            </div>
        );
    }
);

SplitButton.displayName = "SplitButton";
